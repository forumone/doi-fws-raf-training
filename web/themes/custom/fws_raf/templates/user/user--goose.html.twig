{#
/**
 * @file
 * Custom theme implementation to present user data for the RCGR system.
 *
 * This template overrides the default user.html.twig template specifically for
 * the RCGR site when viewing user registration data.
 *
 * Available variables:
 * - content: A list of content items. Use 'content' to print all content, or
 *   print a subset such as 'content.field_example'. Fields attached to a user
 *   such as 'user_picture' are available as 'content.user_picture'.
 * - attributes: HTML attributes for the container element.
 * - user: A Drupal User entity.
 *
 * @see template_preprocess_user()
 */
#}

{%
  set classes = [
    'registration-form',
    'clearfix',
  ]
%}

<article{{ attributes.addClass(classes) }} style="margin-bottom: 22px;">
  {% if user.field_applicant_agree_to_certify.value %}
    <div class="alert alert-success">
      <strong>You have now completed your registration.</strong> This registration is valid ONLY from March 1 â€“ June 30, 2025 for control activities.
    </div>
  {% endif %}

  {# Certification Section - Moved to the very top #}
  <div class="panel panel-primary">
    <div class="panel-heading">
      <h3 class="panel-title">Registrant Certification</h3>
    </div>
    <div class="panel-body">
      <p>I hereby certify that I have read and am familiar with the regulations contained in Title 50, Part 21, section 50, of the Code of Federal Regulations (50 CFR 21.50), and that the information submitted in this registration is complete and accurate to the best of my knowledge and belief. I understand that any false statement herein may subject me to the criminal penalties of 18 U.S.C. 1001.</p>

      {{ drupal_block('certification_form_block') }}
    </div>
  </div>

  <div class="panel panel-primary mt-3">
    <div class="panel-heading">
      <h3 class="panel-title">Registration Information</h3>
    </div>
    <div class="panel-body">
      <div class="table-responsive">
        <table class="table table-bordered table-striped">
          <tbody>
            {# Registration No. #}
            <tr>
              <th class="col-md-3">Registration No.</th>
              <td class="col-md-9">
                {% if user.field_permit_no is defined and user.field_permit_no.value is not empty %}
                  RG-{{ user.field_permit_no.value }}
                {% else %}
                  <div class="alert alert-info">
                    No registration number assigned.
                    <a href="/node/add/location">Add a location</a> to receive a registration number.
                  </div>
                {% endif %}
              </td>
            </tr>

            {# Date of Registration #}
            <tr>
              <th class="col-md-3">Date of Registration</th>
              <td class="col-md-9">{{ user.created.value|date('n/j/Y') }}</td>
            </tr>

            {# Date Amended #}
            <tr>
              <th class="col-md-3">Date Amended</th>
              <td class="col-md-9">{{ user.changed.value|date('n/j/Y') }}</td>
            </tr>

            {# Registrant Name #}
            <tr>
              <th class="col-md-3">Registrant (Landowner) Name</th>
              <td class="col-md-9">
                {% if user.field_bi_cd is defined and user.field_bi_cd.value == 'B' and user.field_applicant_business_name.value is not empty %}
                  {{ user.field_applicant_business_name.value }}
                {% elseif user.field_applicant_last_name.value or user.field_applicant_first_name.value %}
                  {% if user.field_applicant_last_name.value %}{{ user.field_applicant_last_name.value }}{% endif %}
                  {% if user.field_applicant_first_name.value %}, {{ user.field_applicant_first_name.value }}{% endif %}
                {% else %}
                  N/A
                {% endif %}
              </td>
            </tr>

            {# Business Contact Person - only shown for business registrants #}
            {% if user.field_bi_cd is defined and user.field_bi_cd.value == 'B' and (user.field_applicant_last_name.value or user.field_applicant_first_name.value) %}
            <tr>
              <th class="col-md-3">Business Contact Person</th>
              <td class="col-md-9">
                {% if user.field_applicant_last_name.value %}{{ user.field_applicant_last_name.value }}{% endif %}
                {% if user.field_applicant_first_name.value %}, {{ user.field_applicant_first_name.value }}{% endif %}
              </td>
            </tr>
            {% endif %}

            {# Registrant Type #}
            <tr>
              <th class="col-md-3">Registrant Type</th>
              <td class="col-md-9">
                {% if user.field_bi_cd is defined and user.field_bi_cd.value is not empty %}
                  {% if user.field_bi_cd.value == 'I' %}
                    Individual
                  {% elseif user.field_bi_cd.value == 'B' %}
                    Business
                  {% else %}
                    {{ user.field_bi_cd.value }}
                  {% endif %}
                {% else %}
                  N/A
                {% endif %}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  {# Business Information - only shown for business registrants #}
  {% if user.field_bi_cd is defined and user.field_bi_cd.value == 'B' %}
  <div class="panel panel-primary mt-3">
    <div class="panel-heading">
      <h3 class="panel-title">Business Information</h3>
    </div>
    <div class="panel-body">
      <div class="table-responsive">
        <table class="table table-bordered table-striped">
          <tbody>
            {# Primary Contact Information #}
            {% if user.field_primary_contact_name.value is not empty or user.field_primary_contact_phone.value is not empty or user.field_primary_contact_email.value is not empty %}
            <tr>
              <th class="col-md-3">Primary Contact Name</th>
              <td class="col-md-9">
                {% if user.field_primary_contact_name.value %}
                  {{ user.field_primary_contact_name.value }}
                {% else %}
                  N/A
                {% endif %}
              </td>
            </tr>
            <tr>
              <th class="col-md-3">Primary Contact Phone</th>
              <td class="col-md-9">
                {% if user.field_primary_contact_phone.value %}
                  {{ user.field_primary_contact_phone.value }}
                {% else %}
                  N/A
                {% endif %}
              </td>
            </tr>
            <tr>
              <th class="col-md-3">Primary Contact Email</th>
              <td class="col-md-9">
                {% if user.field_primary_contact_email.value %}
                  {{ user.field_primary_contact_email.value }}
                {% else %}
                  N/A
                {% endif %}
              </td>
            </tr>
            {% endif %}

            {# Principal Information #}
            {% if user.field_principal_last_name.value is not empty or user.field_principal_first_name.value is not empty %}
            <tr>
              <th class="col-md-3">Principal Name</th>
              <td class="col-md-9">
                {% if user.field_principal_last_name.value %}{{ user.field_principal_last_name.value }}{% endif %}
                {% if user.field_principal_first_name.value %}, {{ user.field_principal_first_name.value }}{% endif %}
                {% if user.field_principal_middle_name.value %} {{ user.field_principal_middle_name.value }}{% endif %}
                {% if user.field_principal_suffix.value %} {{ user.field_principal_suffix.value }}{% endif %}
              </td>
            </tr>
            {% endif %}

            {% if user.field_principal_title.value is not empty %}
            <tr>
              <th class="col-md-3">Principal Title</th>
              <td class="col-md-9">{{ user.field_principal_title.value }}</td>
            </tr>
            {% endif %}

            {% if user.field_principal_telephone.value is not empty %}
            <tr>
              <th class="col-md-3">Principal Telephone</th>
              <td class="col-md-9">{{ user.field_principal_telephone.value }}</td>
            </tr>
            {% endif %}

            {% if user.field_principal_email.value is not empty %}
            <tr>
              <th class="col-md-3">Principal Email</th>
              <td class="col-md-9">{{ user.field_principal_email.value }}</td>
            </tr>
            {% endif %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
  {% endif %}

  {# Address and Contact Information #}
  <div class="panel panel-primary mt-3">
    <div class="panel-heading">
      <h3 class="panel-title">Registrant Address and Contact Information</h3>
    </div>
    <div class="panel-body">
      <div class="table-responsive">
        <table class="table table-bordered table-striped">
          <tbody>
            <tr>
              <th class="col-md-3">Address</th>
              <td class="col-md-9">
                {% if user.field_applicant_address_l1.value or user.field_applicant_address_l2.value or user.field_applicant_address_l3.value %}
                  <div>{{ user.field_applicant_address_l1.value }}</div>
                  {% if user.field_applicant_address_l2.value %}<div>{{ user.field_applicant_address_l2.value }}</div>{% endif %}
                  {% if user.field_applicant_address_l3.value %}<div>{{ user.field_applicant_address_l3.value }}</div>{% endif %}
                {% else %}
                  N/A
                {% endif %}
              </td>
            </tr>

            <tr>
              <th class="col-md-3">City</th>
              <td class="col-md-9">
                {% if user.field_applicant_city.value %}
                  {{ user.field_applicant_city.value }}
                {% else %}
                  N/A
                {% endif %}
              </td>
            </tr>

            <tr>
              <th class="col-md-3">State</th>
              <td class="col-md-9">
                {% if user.field_applicant_state.value %}
                  {{ user.field_applicant_state.value }}
                {% else %}
                  N/A
                {% endif %}
              </td>
            </tr>

            <tr>
              <th class="col-md-3">ZIP Code</th>
              <td class="col-md-9">
                {% if user.field_applicant_zip.value %}
                  {{ user.field_applicant_zip.value }}
                {% else %}
                  N/A
                {% endif %}
              </td>
            </tr>

            <tr>
              <th class="col-md-3">Telephone</th>
              <td class="col-md-9">
                {% if user.field_applicant_telephone.value %}
                  {{ user.field_applicant_telephone.value }}
                {% else %}
                  N/A
                {% endif %}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</article>
